\documentclass{article} % For LaTeX2e
\usepackage{nips13submit_e,times}
\usepackage{hyperref}
\usepackage{url}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{bbm}

\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator*{\argmax}{\arg\!\max}

\title{An Optimal Control Model of Zebra Finch Vocalization}

\author{
Mike ~Schachter
\thanks{ With a metric ton of help and code from H\'{e}di Soula:
\texttt{hsoula@gmail.com}} \\
Helen Wills Neuroscience Institute\\
University of California, Berkeley\\
Berkeley, CA 94720 \\
\texttt{mike.schachter@gmail.com}
}

% The \author macro works with any number of authors. There are two commands
% used to separate the names and addresses of multiple authors: \And and \AND.
%
% Using \And between authors leaves it to \LaTeX{} to determine where to break
% the lines. Using \AND forces a linebreak at that point. So, if \LaTeX{}
% puts 3 of 4 authors names on the first line, and the last on the second
% line, try using \AND instead of \And before the third author name.

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\nipsfinalcopy % Uncomment for camera-ready version

\begin{document}

\maketitle

\begin{abstract}
In this work, a nonlinear oscillator modeling the syringeal folds of the
Zebra Finch is controlled by the state of higher level linear dynamical system.
We formulate an optimal control cost function and solution for the learning of
bird song.
\end{abstract}

\section{Introduction}

First we'll discuss the Zebra Finch vocalization system and it's mathematical
formulation, and then the control of that system. All code used to generate
figures and results in this paper can be found at:
\begin{center}
   \url{http://github.com/mschachter/birdy}
\end{center}

\subsection{The Zebra Finch Vocalization System}

Like human speech, Zebra Finch song is generated at it's source by oscillations in airflow
generated by vibrating vocal cords. A model for these oscillations is given as:

\begin{align*}
\dot{x}&=\begin{aligned}v\end{aligned} \\
\dot{v}&=\begin{aligned}\gamma^2 \alpha + \gamma^2 \beta x - \gamma^2 x^3 - \gamma x^2 v + \gamma^2 x^2 - \gamma x v\end{aligned}
\end{align*}

The control parameters of the model are $\alpha$ and $\beta$. $\gamma$ = 23500 is a constant.

\subsection{Control of the Syrinx Model}

The goal is to control the parameters $\alpha$ and $\beta$ in order to produce an observed
vocalization. Let $\bm{\phi}(t) = \left[ \alpha(t) ~ \beta(t) \right]^T$ be the state vector.

Assume that the temporal evolution of $\bm{\phi}(t)$ is defined by a controlled linear dynamical
system:

\begin{align*}
\dot{\bm{\phi}}=A\bm{\phi}(t) + \bm{u}(t)
\end{align*}

where $A$ is a 2x2 matrix, chosen to make the passive dynamics of the control system decay
to some physiologically relevant rest state.

We discretized time to simplify the analysis. Let $\Delta\tau$ be the time step for
simulation of the control system, and define $t_k = k\Delta\tau$. Also define
$\bm{\phi}_k = \bm{\phi}(t_k)$. Note that the time step for the simulation of the
control is significantly larger than that of the oscillator. The discrete time map
representing the control system is given by the forward Euler step:

\begin{align*}
\bm{\phi}_{k+1} &= \begin{aligned}\left( A\bm{\phi}_k + \bm{u}_k \right) \Delta\tau + \bm{\phi}_{k}\end{aligned} \\
                &=\begin{aligned}\left( \Delta\tau A + I \right) \bm{\phi}_k + \Delta\tau \bm{u}_k\end{aligned}
\end{align*}

In optimal control theory, a cost function is specified and is to be minimized over time to
produce an optimal control law. But what form should the cost function take? We'll make
the following assumptions:

\begin{enumerate}

\item The control wants to keep the system's instantaneous energy low: $\bm{\phi}_k^T \bm{\phi}_k$.
\item The control wants to keep it's own instantaneous energy low: $\bm{u}^T \bm{u}$ 
\item The control varies smoothly, i.e. $\| \bm{\phi}_k - \bm{\phi}_{k-1} \|$ is small.
\item The control wants to produce an instantaneous fundamental frequency that matches that of a stored template.

\end{enumerate}

To elaborate on the last assumption, say we are given the time-varying fundamental frequency
of a song syllable that we would like to learn, represented as the function $F(t_k)$. Let
$\hat{F} = g(\bm{\phi}_k)$ be the function that gives the steady state fundamental
frequency for a given control $\bm{\phi}_k$. The function $g$ can be empirically
estimated through simulation and approximated through interpolation. To follow this
frequency means to keep the quantity $\left( F(t_k) - g(\bm{\phi}_k) \right) ^2$ small.

Given these assumptions, the cost at time $t_k$ of applying control $\bm{u}$ is:

\begin{align*}
\ell_k \left( \bm{\phi}_{k-1}, \bm{u} \right) = \bm{\phi}_{k}^T \bm{\phi}_{k} +
							\bm{u}^T \bm{u} +
							\| \bm{\phi}_{k} - \bm{\phi}_{k-1} \| +
							\left( F(t_k) - g(\bm{\phi}_{k}) \right) ^2
\end{align*}

Note that the state $\bm{\phi}_k$ is a function of both $\bm{\phi}_{k-1}$ and $\bm{u}$.

Let $N$ be the number of time points we want to control, and let
$\bm{\pi}_j=\{ \bm{u}_j(\bm{\phi}_{j-1}), ..., \bm{u}_N(\bm{\phi}_{N-1}) \}$ be the control
law applied from time $j$ to time $N$. Note that the control law is a sequence of
functions! Each control uses feedback information about most recently observed state.
The total cost of applying a control law $\bm{\pi}_0$ given initial state
$\bm{\phi}_0$ is:

\begin{align*}
v\left( \bm{\phi}_0, \bm{\pi}_0 \right) = \sum_{k=1}^N \ell_k \left( \bm{\phi}_{k-1}, \bm{u}_k \right)
\end{align*}

The optimal cost-to-go is a function that represents the total cost from a time
$j$ to time $N$ given that the optimal control function is applied:

\begin{align*}
v^*_j \left( \bm{\phi}_j \right) = \min_{\bm{\pi}_j} \sum_{k=j}^N \ell_k \left( \bm{\phi}_k, \bm{u}_k \right)
\end{align*}

\subsection{Temporal Hierarchy of Representation}

Generically, we want to determine a joint probability between $\bm{\phi}$ and a set of
variables that are related to the acoustic representation. These features may span several
time scales. For example, instead of just relating $F(t)$ and $\bm{\phi}$, i.e. looking
at the joint distribution $p \left( F(t), \bm{\phi} \right)$, we might want to look
at the running variance of $F(t)$ for a specified time window.

Let $\{ \sigma_1, ..., \sigma_m \}$ be a set of statistics for some acoustic variables. Construct
this set so that they are ordered by time scale. By this, we mean that computing $\sigma_i$
requires a larger window of time than computing $\sigma_j$ if $i < j$.

Finding the optimal control requires maximizing a conditional probability:

\begin{align*}
\argmin_{\bm{u}} C_f = \argmax_{\bm{\phi}(\bm{u})} p \left( \bm{\phi}(\bm{u}) | \sigma_1, ..., \sigma_m \right)
\end{align*}

There may be a "telescoping" algorithm to maximizing $p \left( \bm{\phi}(\bm{u}) | \sigma_1, ..., \sigma_m \right)$
quickly. Start with $\sigma_1$, which is the statistic with the longest time scale.
There should be many instantaneous values of $\bm{u}(t)$ that give a nonzero
probability of occurance with $\sigma_1$. But not all the values will, so restrict the
search for all $\bm{u}$ to that space. Do the same for $\sigma_2$, which will
reduce the size of the space even further. Continue this process until the space of
actual $\bm{u}$ is small enough to do a more efficient optimization, and then
peform that optimization to find the optimal control.


\section*{Acknowledgments}

Thank you to H\'{e}di Soula, who created a C++/Python implementation of this model in our lab
and has provided ideas, expertise, and feedback on this project.

\section*{References}


\small{

\end{document}

